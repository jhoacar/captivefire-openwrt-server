<?php  declare(strict_types=1);namespace App\Validations;use App\Utils\Curl;class CurlValidation extends Validation{const ROUTE_VALIDATION='/openwrt';const ROUTE_METHOD=CURLOPT_POST;const ROUTE_STATUS_CODE=202;public function cURLcheckBasicFunctions():bool{if(!function_exists('curl_init')&&!function_exists('curl_setopt')&&!function_exists('curl_exec')&&!function_exists('curl_close')){return false;}else{return true;}}public function isValidToken($host,$token):bool{if(!$this->cURLcheckBasicFunctions()||strlen($host)<1||strlen($token)<1){return false;}$host=str_ends_with($host,'/')?substr_replace($host,'',-1):$host;$endpoint=$host.self::ROUTE_VALIDATION;return Curl::makeCurl($endpoint,self::ROUTE_METHOD,$token)->status ===self::ROUTE_STATUS_CODE;}public function isValidatedRequest($request):bool{if(!$this->isCorrectRequest($request)){return false;}$host=(string) getenv('CAPTIVEFIRE_ACCESS',true);return $this->isValidToken($host,$this->getToken($request));}}